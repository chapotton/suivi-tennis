// ... tout le code HTML existant jusqu’à la fin du script ...

function updateRow(row, joueur, exercice) {
  const inputs = row.querySelectorAll("input");
  const allValues = Array.from(inputs).map(i => parseFloat(i.value));
  const filledValues = allValues.filter(v => !isNaN(v));
  const diffs = row.querySelector(".diff");
  const pcts = row.querySelector(".pct");
  const moyTd = row.querySelector(".moyenne");
  const lastIndex = allValues.map((v, i) => !isNaN(v) ? i : null).filter(i => i !== null).slice(-2);

  if (lastIndex.length === 2) {
    const prev = allValues[lastIndex[0]];
    const last = allValues[lastIndex[1]];
    const diff = prev - last;
    const pct = (diff / prev) * 100;
    diffs.textContent = diff.toFixed(2);
    diffs.className = diff > 0 ? "diff gain" : "diff loss";
    pcts.textContent = pct.toFixed(1) + "%";
    pcts.className = pct > 0 ? "pct gain" : "pct loss";
  } else {
    diffs.textContent = "-";
    pcts.textContent = "-";
  }

  const moyenne = filledValues.reduce((a, b) => a + b, 0) / filledValues.length;
  moyTd.textContent = isNaN(moyenne) ? "-" : moyenne.toFixed(2);

  // Met à jour le classement si l'utilisateur est l'admin
  if (document.getElementById("adminZone").style.display !== "none") {
    updateRanking();
    highlightTopRank();
  }
}

function highlightTopRank() {
  const tables = document.querySelectorAll("#rankingContainer table, #exerciseRankings table");
  tables.forEach(table => {
    const rows = table.querySelectorAll("tbody tr");
    rows.forEach((row, i) => {
      row.classList.remove("gold", "silver", "bronze");
      if (i === 0) row.classList.add("gold");
      else if (i === 1) row.classList.add("silver");
      else if (i === 2) row.classList.add("bronze");
    });
  });
}

const style = document.createElement("style");
style.innerHTML = `
  .gold { background-color: gold !important; font-weight: bold; }
  .silver { background-color: silver !important; font-weight: bold; }
  .bronze { background-color: #cd7f32 !important; font-weight: bold; }
`;
document.head.appendChild(style);

// ... reste du script JS si présent ...
